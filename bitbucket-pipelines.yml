# This is a sample build configuration for Docker.
# Check our guides at https://confluence.atlassian.com/x/O1toN for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.
image: node:12.16

pipelines:
  default:
    - step:
        name: 'Build and test'
        script:
          - node -v
          - npm -v
          - ls -lha
          - npm install
          - npm update
    - step:
        name: 'Create build'
        artifacts:
          - 'build/**'
        script:
          - echo 'Creating build...'
          - mkdir -p build  # Create directory "build"
          - tar -cjf "${BITBUCKET_BUILD_NUMBER}_dist.tar.bz2" src  # Compress the src dir
          - ls -lha
          - mv "${BITBUCKET_BUILD_NUMBER}_dist.tar.bz2" build  # Move file to build dir
          - ls -lha
